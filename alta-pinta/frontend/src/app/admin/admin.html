<head> 
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css"> 
</head> 

<!-- MENU SUPERIOR -->
<nav class="navbar navbar-expand-lg navbar-light bg-light shadow-sm mb-4">
  <div class="container-fluid">
    <a class="navbar-brand fw-bold" href="#">
      <i class="bi bi-speedometer2 me-1"></i> TrendyShop Admin
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" 
            data-bs-target="#navbarNav" aria-controls="navbarNav" 
            aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ms-auto">
        <li class="nav-item">
          <a class="nav-link active" role="button" (click)="irAdmin()">
            <i class="bi bi-house-door me-1"></i> Panel Admin
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" role="button" (click)="irProductos()">
            <i class="bi bi-box-seam me-1"></i> Productos
          </a>
        </li>
        <li class="nav-item">
        <a class="nav-link text-danger" role="button" (click)="logout()">
          <i class="bi bi-box-arrow-right me-1"></i> Cerrar Sesión
          </a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="container py-4">

  <h3 class="fw-bold mb-4">
    <i class="bi bi-bar-chart me-2"></i> Panel de Administración
  </h3>

  <div class="card card-tarjeta mb-4">
    <div class="card-body">
      <h6 class="fw-bold mb-3"><i class="bi bi-credit-card-2-front me-2"></i>Recargar Saldo de Tarjeta</h6>
      <div class="row g-3 align-items-end">
        <div class="col-md-6">
          <input type="text" class="form-control" placeholder="Número de tarjeta" [(ngModel)]="recargarNumero">
        </div>
        <div class="col-md-4">
          <input type="number" class="form-control" placeholder="Monto" [(ngModel)]="recargarMonto">
        </div>
        <div class="col-md-2">
          <button class="btn btn-outline-secondary w-100" (click)="recargarTarjeta()">Recargar</button>
        </div>
      </div>
      <div class="mt-2" *ngIf="recargarMensaje" class="alert alert-info">{{ recargarMensaje }}</div>
    </div>
  </div>

  <!-- TOTAL VENDIDO / PEDIDOS -->
  <div class="row mb-4">
    <div class="col-md-6">
      <div class="card card-total text-center">
        <div class="card-body">
          <h6>Total Vendido</h6>
          <h3>S/ {{ totalVendido }}</h3>
        </div>
      </div>
    </div>
    <div class="col-md-6">
      <div class="card card-pedidos text-center">
        <div class="card-body">
          <h6>Pedidos Pagados</h6>
          <h3>{{ totalPedidos }}</h3>
        </div>
      </div>
    </div>
  </div>

  <!-- FILTROS POR PERIODO -->
  <div class="card card-ventas mb-4">
    <div class="card-body">
      <h6 class="fw-bold mb-3"><i class="bi bi-calendar3 me-2"></i>Ventas por periodo</h6>
      <div class="row g-3 align-items-end">
        <div class="col-md-3">
          <label>Día</label>
          <input type="date" [(ngModel)]="fecha" class="form-control">
          <button class="btn btn-outline-primary mt-2 w-100" (click)="buscarDia()">Buscar</button>
        </div>
        <div class="col-md-3">
          <label>Mes</label>
          <input type="number" [(ngModel)]="mes" class="form-control">
        </div>
        <div class="col-md-3">
          <label>Año</label>
          <input type="number" [(ngModel)]="anio" class="form-control">
        </div>
        <div class="col-md-3 d-grid gap-2">
          <button class="btn btn-outline-success w-100" (click)="buscarMes()">Mes</button>
          <button class="btn btn-outline-dark w-100" (click)="buscarAnio()">Año</button>
        </div>
      </div>
      <div class="alert alert-info mt-3" *ngIf="resultadoFiltro !== null">
        Total vendido: <b>S/ {{ resultadoFiltro }}</b>
      </div>
    </div>
  </div>

  <!-- PEDIDOS / CAMBIO DE ESTADO -->
<div class="card card-pedidos-estado mb-4">
  <div class="card-body">
    <h6 class="fw-bold mb-3">
      <i class="bi bi-list-check me-2"></i> Pedidos
    </h6>
    <div class="table-responsive">
      <table class="table table-hover table-pedidos align-middle">
        <thead>
          <tr>
            <th>ID</th>
            <th>Cliente</th>
            <th>Total</th>
            <th>Estado</th>
            <th>Actualizar Estado</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let pedido of pedidos">
            <td>{{ pedido.id }}</td>
            <td>{{ pedido.clienteCorreo }}</td>
            <td>S/ {{ pedido.total }}</td>
            <td>
              <span class="badge estado-badge"
                    [ngClass]="{
                      'pagado': pedido.estado==='PAGADO',
                      'enviado': pedido.estado==='ENVIADO',
                      'en-transito': pedido.estado==='EN TRANSITO',
                      'en-destino': pedido.estado==='EN DESTINO',
                      'entregado': pedido.estado==='ENTREGADO'
                    }">
                {{ pedido.estado }}
              </span>
            </td>
            <td>
              <select class="form-select mb-1" [(ngModel)]="pedido.estado">
                <option value="PAGADO">PAGADO</option>
                <option value="ENVIADO">ENVIADO</option>
                <option value="EN TRANSITO">EN TRANSITO</option>
                <option value="EN DESTINO">EN DESTINO</option>
                <option value="ENTREGADO">ENTREGADO</option>
              </select>
              <button class="btn btn-sm btn-success w-100" (click)="actualizarEstado(pedido)">
                <i class="bi bi-arrow-repeat me-1"></i> Actualizar
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

</div>
