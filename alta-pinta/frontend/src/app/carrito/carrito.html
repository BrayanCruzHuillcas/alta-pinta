<head> 
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css"> 
</head> 

<nav class="navbar navbar-expand-lg menu-top shadow-sm"> 
  <div class="container-fluid d-flex align-items-center"> 
      <div class="d-flex align-items-center logo-box " role="button" (click)="irMenu()"></div> 
      <!--<i class="bi bi-list menu-icon " role="button" (click)="irMenu()"></i>--> 
      <ul class="navbar-nav gap-4 fw-semibold nav-categorias"> 
          <li class="nav-item" *ngFor="let c of categorias"> 
              <a class="nav-link" (click)="irCategoria(c.nombre)"> 
                {{ c.nombre.toUpperCase() }} 
              </a> 
          </li> 
      </ul> 

      <div class="icons"> 
        <i class="bi bi-person-fill"role="button" (click)="irPerfil()"></i>
        <i class="bi bi-heart" role="button" (click)="irFavoritos()"></i> 
 
        <div class="cart-icon" role="button" (click)="irCarrito()"> 
          <i class="bi bi-cart"></i> 
          <span class="badge" *ngIf="contadorCarrito > 0"> 
            {{ contadorCarrito }} 
          </span> 
        </div> 

        <div class="logout" role="button" (click)="cerrarSesion()"> 
          <i class="bi bi-box-arrow-in-right"></i> 
          <span>Cerrar Sesión</span> 
        </div> 
      </div> 
  </div> 
</nav> 

<div class="container my-5"> 
  <div class="mb-4"> 
    <h4 class="fw-bold">
      TU CARRITO 
      <span class="text-muted fs-6">({{ items.length }} ARTÍCULOS)</span>
    </h4> 
    <p class="text-muted small"> 
      Los artículos en tu carrito no están reservados. Finaliza tu compra para asegurarlos. 
    </p> 
  </div> 

  <div class="row"> 
    <div class="col-lg-8"> 

      <div *ngIf="items.length === 0" class="alert alert-warning"> 
        Tu carrito está vacío 
      </div> 

      <div *ngFor="let i of items" class="cart-item d-flex mb-4 p-3"> 
        <div class="cart-img"> 
          <img 
            [src]="i.imagenUrl"
            alt="{{ i.nombre }}"
            width="100">
        </div> 

        <div class="flex-grow-1 ms-3"> 
          <div class="d-flex justify-content-between"> 
            <h6 class="fw-semibold mb-1">
              {{ i.nombre }}
            </h6> 

            <button 
              class="btn btn-sm btn-outline-danger"
              (click)="eliminar(i)">
              <i class="bi bi-x-lg"></i> 
            </button> 
          </div> 

          <div class="d-flex align-items-center justify-content-between mt-2"> 
            <div class="quantity-control">
              <button class="btn btn-qty" (click)="decrementar(i)">−</button>

              <input
                type="number"
                class="form-control form-control-sm text-center"
                [(ngModel)]="i.cantidad"
                (ngModelChange)="actualizarCantidad(i)"
                min="0"
              />

              <button class="btn btn-qty" (click)="incrementar(i)">+</button>
            </div>

            <div class="fw-bold"> 
              S/ {{ i.cantidad * i.precio | number:'1.2-2' }} 
            </div> 
          </div> 
        </div> 
      </div> 
    </div> 

    <div class="col-lg-4">
  <div class="summary-box">

    <h6 class="summary-title">
      <i class="bi bi-receipt-cutoff"></i> Resumen de pedido
    </h6>

    <div class="summary-row">
      <span>{{ items.length }} productos</span>
      <span>S/ {{ total | number:'1.2-2' }}</span>
    </div>

    <div class="mb-3">
      <label class="form-label fw-semibold">Tipo de envío</label>
      <select class="form-select" [(ngModel)]="tipoEnvio" (change)="calcularTotal()">
        <option value="RECOJO">Recojo en tienda</option>
        <option value="ENVIO">Envío a domicilio</option>
      </select>
    </div>

    <div class="mb-3" *ngIf="tipoEnvio === 'ENVIO'">
      <label class="form-label fw-semibold">Departamento de envío</label>
      <select class="form-select" [(ngModel)]="envioSeleccionado" (change)="calcularTotal()">
        <option *ngFor="let e of envios" [ngValue]="e">
          {{ e.lugar }} - S/ {{ e.costo }}
        </option>
      </select>
    </div>

    <div class="summary-row">
      <span>Entrega</span>
      <span class="envio-gratis" *ngIf="tipoEnvio === 'RECOJO'">Gratis</span>
      <span class="envio-costo" *ngIf="tipoEnvio === 'ENVIO'">
        S/ {{ envioSeleccionado?.costo | number:'1.2-2' }}
      </span>
    </div>

    <hr>

    <div class="summary-total">
      <span>Total</span>
      <span>S/ {{ total | number:'1.2-2' }}</span>
    </div>

    <button class="btn btn-checkout" (click)="irPagar()">
      <i class="bi bi-wallet-fill"></i> Ir a pagar
    </button>

    <small class="summary-secure">
      <i class="bi bi-shield-lock-fill"></i> Pago 100% seguro
    </small>

  </div>
</div>
  </div> 
</div>
