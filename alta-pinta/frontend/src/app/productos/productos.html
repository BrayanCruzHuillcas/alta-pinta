<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

<!-- MENU SUPERIOR -->
<nav class="navbar navbar-expand-lg navbar-light bg-light shadow-sm mb-4">
  <div class="container-fluid">
    <a class="navbar-brand fw-bold" href="#">
      <i class="bi bi-speedometer2 me-1"></i> Alta Pinta - Admin
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" 
            data-bs-target="#navbarNav" aria-controls="navbarNav" 
            aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ms-auto">
        <li class="nav-item">
          <a class="nav-link active" role="button" (click)="irAdmin()">
            <i class="bi bi-house-door me-1"></i> Panel Admin
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" role="button" (click)="irProductos()">
            <i class="bi bi-box-seam me-1"></i> Productos
          </a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="nubes"></div>
<div class="nubes2"></div>
<div class="container py-5" id="contenedor-principal">

    <h2 class="text-center titulo-animado">Gestión de Productos</h2>

    <form class="card p-4 sombra-form" (ngSubmit)="guardar()">

        <div class="row g-3">

            <div class="col-md-6">
                <label class="form-label fw-semibold text-secondary">Nombre del Producto</label>
                <input type="text" class="form-control input-glow" [(ngModel)]="producto.nombre" name="nombre" required>
            </div>

            <div class="col-md-6">
                <label class="form-label fw-semibold text-secondary">Precio (S/.)</label>
                <input type="number" min="1" step="0.1" class="form-control input-glow" [(ngModel)]="producto.precio" name="precio">
            </div>

            <div class="col-md-12">
                <label class="form-label fw-semibold text-secondary">Descripción</label>
                <textarea rows="3" class="form-control input-glow" [(ngModel)]="producto.descripcion" name="descripcion"></textarea>
            </div>

            <div class="col-md-4">
                <label class="form-label text-secondary">Stock</label>
                <input type="number" class="form-control input-glow" [(ngModel)]="producto.stock" name="stock">
            </div>

            <div class="col-md-4">
                <label class="form-label text-secondary">Categoría</label>
                <select class="form-select input-glow" [(ngModel)]="producto.categoria" name="categoria">
                    <option *ngFor="let c of categorias" [ngValue]="c">{{c.nombre}}</option>
                </select>
            </div>

            <div class="col-md-4">
                <label class="form-label text-secondary">Tipo Prenda</label>
                <select class="form-select input-glow" [(ngModel)]="producto.tipoPrenda" name="tipoPrenda">
                    <option *ngFor="let t of tipos" [ngValue]="t">{{t.nombre}}</option>
                </select>
            </div>

            <div class="col-md-4">
                <label class="form-label text-secondary">Talla</label>
                <select class="form-select input-glow" [(ngModel)]="producto.talla" name="talla">
                    <option *ngFor="let ts of tallas" [ngValue]="ts">{{ts.nombre}}</option>
                </select>
            </div>

            <div class="col-md-8">
                <label class="form-label text-secondary">URL Imagen</label>
                <input type="text" class="form-control input-glow" [(ngModel)]="producto.imagenUrl" name="imagenUrl">
            </div>
        </div>

        <button class="btn btn-gradiente w-100 mt-4">
            <i class="bi fs-5" [ngClass]="{ 'bi-cloud-upload-fill': !modoEdicion , 'bi-pencil-fill': modoEdicion }"></i>
            {{ modoEdicion ? 'Actualizar Producto' : 'Registrar Producto' }}
        </button>
    </form>

    <div class="table-responsive rounded-4 mt-5">
        <table class="table table-hover align-middle text-center tabla-animada">
            <thead class="table-gradient">
                <tr>
                    <th>Imagen</th> <th>Nombre</th> <th>Precio</th> <th>Categoría</th>
                    <th>Tipo</th> <th>Talla</th> <th>Stock</th> <th>Acciones</th>
                </tr>
            </thead>

            <tbody>
                <tr *ngFor="let p of productos" class="fila-hover">
                    <td><img [src]="p.imagenUrl" class="img-producto"></td>
                    <td>{{p.nombre}}</td>
                    <td>S/ {{p.precio}}</td>
                    <td>{{p.categoria?.nombre}}</td>
                    <td>{{p.tipoPrenda?.nombre}}</td>
                    <td>{{p.talla?.nombre}}</td>
                    <td>{{p.stock}}</td>
                    <td>
                        <button class="btn btn-warning btn-sm me-2" (click)="editar(p)">
                            <i class="bi bi-pencil-square"></i>
                        </button>
                        <button class="btn btn-danger btn-sm" (click)="eliminar(p.id)">
                            <i class="bi bi-trash3-fill"></i>
                        </button>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

</div>
